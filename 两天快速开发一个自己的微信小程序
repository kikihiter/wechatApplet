https://www.cnblogs.com/xuanbiyijue/p/7980010.html
悬笔e绝
www.xuanbiyijue.com
两天快速开发一个自己的微信小程序
~~~ 更新于2018年8月7日 ~~~

你们要的前端、服务端、数据库一整套的小程序项目来了

熬夜新写的小程序《 mpvue-xbyjShop 》

附上几张效果图，代码传到GitHub了，喜欢的童鞋可以star，打赏、点赞、扔硬币、仍香蕉哦~

代码地址：https://github.com/yllg/mpvue-xbyjShop

-- 首页、商品详情页

                        

 

-- 购物车、个人中心

                    

 

 

~~~ 更新于2018年6月29日 ~~~

目前最喜欢的个人项目--《跨平台音乐播放器xbyjMusic 》

附上两张效果图，代码传到GitHub了，喜欢的童鞋可以star或者fork和我一起完善它哦~😜

代码地址：https://github.com/yllg/xbyjMusic

 

--首页



 

--歌曲页

 

 

--------------------------------------------------正文从这里开始-----------------------------------------

 

一．写在前面

1.为什么要学小程序开发？

    对于前端开发而言，微信小程序因为其简单快速、开发成本低、用户流量巨大等特点，也就成了前端开发工程师必会的一个技能。

 

2.先放上我做的小程序

可以在微信小程序搜索“悬笔e绝”，或者用微信扫描下面的二维码

（最近接小程序广告了，喜欢本项目的话，可以点广告支持我一下哈 ~ 谢谢 (*^▽^*) ）

 



 

 

（1）欢迎页：这个logo是当年念大学给社团做的logo，苦学了整整一周的PS啊。。。



 

 

（2）首页：轮播头图，天气，豆瓣电影正在热映



 

 

（3）全国城市切换页



 

（4）天气详情页



 

（5）地图周边服务



 

（6）豆瓣电影

 

 

（7）热点新闻



 

（8）更多页面



 

3.开发准备：

（1）有人开玩笑说，会vue小程序根本都不用学：

微信小程序虽然是腾讯自己搞的，但是核心的思想跟vue等框架是一样一样的哦~

（2）善于搜集精美的小组件： “我们不生产代码，我们只是代码的搬运工”，善于找到想要的组件并把他们巧妙优雅的组装成一个大项目，也算是程序员一项基本技能了。

具体怎么找到想要的小程序demo，篇末会给大家推荐小程序的资源，有很多大神的项目哦

 

 

 

 撸起袖子开干了

 

一.注册小程序账号，下载IDE

1.官网注册https://mp.weixin.qq.com/，并下载IDE。

2.官方文档一向都是最好的学习资料。

注意：

（1）注册账号之后会有一个appid，新建项目的时候需要填上，不然很多功能是用不了的，比如不能预览，不能上传代码等等。

（2）如果你注册过微信公众号的话，一定要注意，微信公众号和小程序是两个账号，二者的appid也是不同，小程序开发必须使用小程序的appid哦。



 

二.小程序框架介绍和运行机制

1.我们建立了“普通快速启动模板”，然后整个项目目录如下：



2.app.js

整个项目的启动文件，如注释写的onlaunch方法有三大功能，浏览器缓存进行存和取数据；用登陆成功的回调；获取用户信息。

globalData是定义整个项目的全局变量或者常量哦。

 

3.app.json

整个项目的配置文件，比如注册页面，配置tab页，设置整个项目的样式，页面标题等等；

！注意：小程序启动默认的第一个页面，就是app.json的pages中的第一个页面哦。

4.pages

小程序的页面组件，有几个页面就会有几个子文件夹。比如快速启动模板，就有两个页面，index和logs

5.打开index目录

可以看到有三个文件，其实和我们web开发的文件是一一对应的。

index.wxml对应index.html；

index.wxss对应index.css；

index.js就是js文件哦。

一般我们还会给每个页面组件添加一个.json文件，作为该页面组件的配置文件，设置页面标题等功能

6.双击index.js文件

（1）var app = getApp(); 

引入整个项目的app.js文件，用来取期中的公共变量等信息。

如果要使用util.js工具库中的某个方法，在util.js中module.exports导出，然后在需要的页面中require即可得到哦。

（2）比如，我们要获取豆瓣电影的时候，我们需要调用豆瓣的api；我们先在app.js中的gloabData中定义doubanBase

然后在index.js中使用app.globaData.doubanBase即可取到这个值。

当然这些常量你也可以在页面需要的时候，再用写死的值，但是为了整个项目的维护，还是建议把这种公用参数统一写在配置文件中哦。



 



（3）接下来在整个page({})中，第一个data，就是本页面组件的内部数据，会渲染到该页面的wxml文件中，类似于vue、react哦~

通过setData修改data数据，驱动页面渲染



（4）一些生命周期函数

比如onload()， onready(), onshow(), onhide()等等，监听页面加载、页面初次渲染、页面显示、页面隐藏等等

更多的可以查官网API哦。其中用的最多的就是onload()方法，和onShareAppMessage()方法（设置页面分享的信息）

 

7 .wxml模板的使用。

比如本项目电影页面，就是以最小的星级评价组件wxml当做模板，star到movie到movie-list，一级一级的嵌套使用。

 star-template.wxml页面写好name属性；然后import引入的时候通过name获得即可





 

8.常用的wxml标签

view，text，icon，swiper，block，scroll-view等等，这些标签直接查官网文档即可

 

 

三.小程序框架、各个页面以及发布上线的注意点

 

1.整个框架中的一些注意点

（1）整个wxml页面，最底层的标签是<page></page>哦。

（2） 每个页面顶部导航栏的颜色，title在本页面的json中配置，如果没有配置的话，取app.json中的总配置哦。

（3）json中不能写注释哦，不然会报错的。

（4）路由相关



1）使用wx.SwitchTab跳转tab页的话，在app.json中除了注册pages页面，还需要在tabBar中注册tab页，才能生效哦。

注意：tab最多5个，也就是我们说的头部或者底部最多5个菜单。其他的页面只能通过其他路由方法打开哦。

2）navigateTo是跳到某个非tab页，比如欢迎页，电影详情页，城市选择页；在app.json中注册后，不能在tabBar里注册哦，不然同样也是不能跳转的哦。

3）reLaunch跳转，新开的页面左上角是没有退回按钮的，本项目只用了一次，切换城市的时候哦。

（5）页面之间传递参数

参数写在跳转的url之中，然后另一个页面在onload方法中的传参option接收到。如下传递和获取id





 

（6）data-开头的自定义属性的使用

比如wxml中我们怎么写 

点击的事件对象可以这么取，var postId = event.currentTarget.dataset.postid;

注意： 大写会转换成小写，带_符号会转成驼峰形式

（7）事件对象event，event.target和event.currentTarget的区别：

target指的是当前点击的组件 和currentTarget 指的是事件捕获的组件。

比如，轮播图组件，点击事件应该要绑定到swiper上，这样才能监控任意一张图片是否被点击，

这时target这里指的是image（因为点击的是图片），而currentTarget指的是swiper（因为绑定点击事件在swiper上）

（8）使用免费的网络接口：

本项目中用到了 和风天气api，腾讯地图api，百度地图api，豆瓣电影api，聚合头条新闻api等，具体用法可以看各自官网的接口文档哦，很详细的

注意：免费接口是有访问限制的，所以如果用别人的组件用了这种接口的话，最好还是自己注册一个新的key替换上哦

附上一个免费接口大全：

https://github.com/jokermonn/-Api



！！另外还要注意，要把这些接口的域名配置到小程序的合法域名中，不然也是访问不了的



（8）wxss有一个坑：无法读取本地资源，比如背景图片用本地就会报错哦。

把本地图片弄成网络图片的几种方式： 上传到个人网站；QQ空间相册等等也是可以的哦

 

 

2.切换城市页面：

（1）首页使用navigateTo跳转到切换城市页，由于首页并没有关闭，导致切换了城市返回来，天气信息还是旧的。

正确的处理逻辑如下：

1）使用reLaunch跳转到切换城市页面，实质是关闭所有页面打开新的页面哦。

2）切换城市页面，更新公共变量中城市信息为手动切换的城区，再switchTab回到首页，触发首页重新加载。

3）首页获取城市信息的时候加一个判断，全局没有才取定位的，全局有（比如刚才设置了）就用全局的哦。

（2）城市列表的滚动和回到顶部

基于scroll-view组件的scroll-top属性，初始就是0，滚动就会增加的；点击回到顶部给它置为0即可回到顶部

 

 

3.天气页

（1）初始化页面，天气显示的逻辑

首先调用小程序的wx.getLocation方法获得当前的经纬度，然后调用腾讯地图获得当前的城市名称和区县名称，并存到公共变量中，

再调用查询天气和空气质量的方法哦。

（2）容错处理

城市的名称长短不一，有点名字特别长，比如巴彦淖尔市这种，需要动态的获取完整的城市名称；

有些偏僻的城市暂时没有天气信息，我们需要对返回的结果进行判断，没有信息的需要给用户一个良好的提示信息。

 

 

4.周边-地图服务页面

（1）调用百度地图的各种服务，查询酒店，美食，生活服务三种信息，更多信息可以看百度地图的文档

（2）点击时给被点中的图标加个边框，数据驱动视图，所以使用一个长度为3的数组保存三个图标当前是否被点中的状态

然后wxml再根据数据来动态添加class，增加边框样式

 

5.豆瓣电影页

（1）电影详情页的预览图片，用小程序本身的previewImage实现。

（2）详情页使用onReachBottom()方法，监控用户上拉触底事件，然后发送请求继续获得数据，实现懒加载的效果

（3）用户体验方面的优化，js中将整数评分比如7分统一改为7.0分，然后wxml模板再判断分数是否为0显示“暂无评分”

（4）搜索之后清空搜索框

因为小程序中不能使用getelementbyId这种方式获得元素，只能用数据来控制了

在data中加一个属性searchText来保存搜索框的内容并和 input的value属性绑定，搜索完成或者点击X时，searchText变量清空即可实现清空输入框的效果哦。

 

6.新闻页面

（1）聚合头条新闻的免费接口，只返回了新闻的基本信息，新闻的主体内容是没有的哦。

我找了好多新闻类的接口，好像都是没有新闻主体内容的。如果谁知道更好的接口欢迎留言告诉我哈~

（2）当然，也可以自己去爬新闻网站的数据哦

 

7.更多页面

 （1）小程序目前开放外链的功能只是给公司组织的小程序开放了，个人开发还是不能使用外链的哦。

 （2）彩蛋页面，获得用户信息

通过 wx.setStorageSync('userInfos', userInfos);  可以获得登陆小程序的用户的个人信息，可以发送给后台存到数据库中，方便对用户进行分析

我这里只是存储到浏览器缓存中哦，最大应该是10M缓存；如果用户把这个小程序从小程序列表中删除掉，就会清空这个缓存。

 

8.发布注意

（1） 新版本小程序发布的限制为2M，一般都是图片最占空间，所以尽量使用网络图片

具体怎么把本地图片变成网络图片，上面有讲哦。

（2）在开发者工具上预览测试没问题，点击上传；网页版小程序个的人中心的左侧“开发管理”菜单，第三块--开发版本就有了内容。

（3）点击提交，填写小程序相关信息，就可以提交审核了哦。

注意：分类最好填写准确，这样才能更快的通过审核哦。我这个小程序一天半时间过审上线的

 

 

至此，我就把两天开发内碰到的坑和注意点都过了一遍，据说还有更多的坑，等之后更深入的开发再继续研究咯。

 

 

四.写在最后

1.推荐几个小程序开发的资料

（1）知乎一篇小程序的资料：

https://www.zhihu.com/question/50907897

（2）小程序社区

http://www.wxapp-union.com/portal.php

（3）极乐小程序商店

http://store.dreawer.com/

2.我的个人微信公众号--悬笔e绝，欢迎关注哈~



3.本项目的github地址，喜欢的童鞋点个star哈~

 https://github.com/yllg/WXxcx

 

4.我的个人博客网站： 之后原创文章都会写在这里，然后不定期加一些酷炫的效果上去，嘿嘿嘿

http://www.xuanbiyijue.com/

 

 

 

 

 

 

 ！转载请注明出处哦！😝

 

 

分类: 小程序
标签: 微信小程序
好文要顶 关注我 收藏该文    
悬笔e绝
关注 - 3
粉丝 - 76
+加关注
17 0
« 上一篇：webpack中实现按需加载
» 下一篇：如何在Blog中加入Google Analytics
posted on 2017-12-06 19:28 悬笔e绝 阅读(218102) 评论(8) 编辑 收藏

评论
#1楼 2018-03-12 21:56 小潇洒  
谢谢大神，多多学习
支持(0)反对(0)
  
#2楼 2018-05-23 19:18 女先生ACE  
很有用，收藏了，请问楼主有请求链接后台的代码吗？？？ 后台怎么接？？
支持(1)反对(0)
  
#3楼 2018-06-07 23:26 石头张  
大神，能再写一篇关于小程序的发布、服务器的部署和数据库的管理方案吗？跪求大神指点，可否加QQ或者微信，详聊
支持(4)反对(0)
  
#4楼 2018-07-27 10:52 林石  
为什么我本地编译 豆瓣的接口 全部403 ?
支持(0)反对(0)
  
#5楼 2018-07-30 16:59 lhmmhs  
@ 林石
豆瓣接口屏蔽微信小程序了
支持(0)反对(0)
  
#6楼[楼主] 2018-07-30 19:28 悬笔e绝  
@ 女先生ACE
我最近再写一个mpvue小程序商城项目，nodejs后台+mysql数据库，可以关注我的公众号，之后也会开源的哦~
支持(0)反对(0)
  
#7楼[楼主] 2018-07-30 19:29 悬笔e绝  
@ 石头张
我最近再写一个mpvue小程序商城项目，nodejs后台+mysql数据库，可以关注我的公众号，之后也会开源的哦~
支持(0)反对(0)
  
#8楼[楼主] 2018-07-30 19:30 悬笔e绝  
@ lhmmhs
bingo~
支持(0)反对(0)
  
刷新评论刷新页面返回顶部
注册用户登录后才能发表评论，请 登录 或 注册，访问网站首页。
最新IT新闻:
· 红芯致歉背后：研发一款国产自主浏览器内核到底有多难
· 经济学人封面文章：互联网如何改变现代爱情
· 深交所：对本周买入乐视网金额较大账户进行风险提示
· Google Goggles已经被Google Lens取代
· 微软计划开源ONE，强大的开放网络模拟器
» 更多新闻...
最新知识库文章:
· 被踢出去的用户
· 成为一个有目标的学习者
· 历史转折中的“杭派工程师”
· 如何提高代码质量？
· 在腾讯的八年，我的职业思考
» 更多知识库文章...
Powered by: 
博客园 
Copyright © 悬笔e绝

<	2018年8月	>
日	一	二	三	四	五	六
29	30	31	1	2	3	4
5	6	7	8	9	10	11
12	13	14	15	16	17	18
19	20	21	22	23	24	25
26	27	28	29	30	31	1
2	3	4	5	6	7	8
导航
博客园
首页
新随笔
联系
订阅订阅
管理
统计
随笔 - 37
文章 - 0
评论 - 8
引用 - 0
公告
昵称：悬笔e绝
园龄：1年1个月
粉丝：76
关注：3
+加关注
搜索

 找找看

 谷歌搜索
常用链接
我的随笔
我的评论
我的参与
最新评论
我的标签
我的标签
JS(3)
node.js(3)
nodejs(3)
mac(2)
微信小程序(2)
小程序(2)
git(2)
Github(2)
VSCode(2)
web(1)
更多
随笔分类
.net(2)
canvas(1)
css(2)
http(2)
JS(8)
JS&QA(2)
LINUX(2)
mac(2)
node.js(6)
版本管理控制工具(5)
命令行工具(2)
前端IDE，编辑器(2)
小程序(3)
随笔档案
2018年1月 (1)
2017年12月 (6)
2017年11月 (18)
2017年10月 (12)
最新评论
1. Re:两天快速开发一个自己的微信小程序
@lhmmhsbingo~...
--悬笔e绝
2. Re:两天快速开发一个自己的微信小程序
@石头张我最近再写一个mpvue小程序商城项目，nodejs后台+mysql数据库，可以关注我的公众号，之后也会开源的哦~...
--悬笔e绝
3. Re:两天快速开发一个自己的微信小程序
@女先生ACE我最近再写一个mpvue小程序商城项目，nodejs后台+mysql数据库，可以关注我的公众号，之后也会开源的哦~...
--悬笔e绝
4. Re:两天快速开发一个自己的微信小程序
@林石豆瓣接口屏蔽微信小程序了...
--lhmmhs
5. Re:两天快速开发一个自己的微信小程序
为什么我本地编译 豆瓣的接口 全部403 ?
--林石
阅读排行榜
1. 两天快速开发一个自己的微信小程序(218076)
2. 如何在Blog中加入Google Analytics(1675)
3. mac 常用的开发工具(829)
4. 小程序 居中布局 解决方案(740)
5. 微信小程序开发工具 常用快捷键(518)
评论排行榜
1. 两天快速开发一个自己的微信小程序(8)
推荐排行榜
1. 两天快速开发一个自己的微信小程序(17)
2. 小程序 居中布局 解决方案(1)
